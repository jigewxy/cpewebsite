<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Expires" content="Tue, 01 Jan 1995 12:12:12 GMT">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Cache-control" content="no-cache">
</head>
<body>

<!-- ng-controller is defined in cpe_projects.html, this is just a route -->
<div class="container-fluid">
	<div class="left-nav-menu col-md-2">
		<ul class="list-group">
			<li class="list-group-item tool-box" data-toggle="modal" data-target="#add-new-project-modal"><center><img class="nav-menu-image" src="images/project_create.png"></center><span class="overlay-add overlay"><div class="overlay-text">Add Project</div></span></li>
			<li class="list-group-item tool-box" ng-click="renderModal.delPj()"><center><img class="nav-menu-image" src="images/project_delete.png"></center><span class="overlay-del overlay"><div class="overlay-text">Delete Project</div></span></li>
			<li class="list-group-item list-btn"><button id="show-all-btn" class="btn" ng-click="setFilterFn($event)">Show All</button></li> 
			<li class="list-group-item list-btn"><button id="state-filter-btn" class="btn" ng-click="setFilterFn($event)">By Schedule</button></li> 
			<li class="list-group-item list-btn"><button id="tag-filter-btn" class="btn" ng-click="setFilterFn($event)">By Tagname</button></li>
			<li class="list-group-item list-btn"><button id="cat-filter-btn" class="btn" ng-click="setFilterFn($event)">By Category</button></li>

		</ul>
	</div>



<div class="panel-group project-panel-group">
<!--LEARNING built-in filter doesn't work with object iteration !-->
	<div ng-repeat="(headers,custFilter) in filterMap" class="col-md-9">
		<h4 class="table-header">{{headers}}</h4>
		<table class= "table table-hover table-bordered active-pj-table">
		<tr><th>#</th><th>Project Name</th><th>FC Date</th> <th>RC Date</th> <th>VR Date</th><th>Project Manager</th><th>Firmware Integrator</th></tr>
		<tr ng-repeat="project in projectobjs | filter:keyword | filter: custFilter" data-toggle="modal" data-target="#active-project-modal" ng-click="selDatabase(project.pjname)"><td>{{$index+1}}</td><td class="td-pj"><a>{{project.pjname}}</a></td><td>{{projectinfo[project.pjname].datefc}}</td>
		<td>{{projectinfo[project.pjname].daterc}}</td> <td>{{projectinfo[project.pjname].datevr}}</td><td>{{projectinfo[project.pjname].pm}}</td>
		<td>{{projectinfo[project.pjname].fw}}</td> </tr>
		</table>
	</div>

<!-- Show project charter modal-->
<div id="active-project-modal" class="modal fade" role="dialog">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
			<h4 class="modal-title text-primary"><center>Project Charter - {{projectname}}</center></h4>
			<button type="button" class="close" data-dismiss="modal">&times;</button>
			<button class="btn btn-warning pull-left" data-hover="tooltip" data-toggle="modal" data-target="#move-project-modal" data-placement="bottom" title="Copy project to &quot;Completed Project&quot; database." ng-click="defectCounter()"> 
				Mark Project Completion
			<span class="glyphicon glyphicon-paste"> </span></button>
      </div>

      <div class="modal-body">
	 <div class="col-md-6">
	 	<table class= "table table-striped table-bordered table-hover table-condensed summary-table col-md-4">
			<tr><td class="bg-info" width="30%"> SKUs </td> <td  > {{projectdata.skus}}</td></tr>
			<tr><td class="bg-info"> Tagname </td> <td  >{{projectdata.tag}}</td></tr>
			<tr><td class="bg-info"> Product Category </td> <td>{{projectdata.division}}</td></tr>
			<tr><td class="bg-info"> Start Date </td> <td  > {{projectdata.datestart}}</td></tr>
			<tr><td class="bg-info"> FC Date </td> <td  > {{projectdata.datefc}}</td></tr>
			<tr><td class="bg-info"> RC Date </td> <td  > {{projectdata.daterc}}</td></tr>
			<tr><td class="bg-info"> VR Date </td> <td  >{{projectdata.datevr}}</td></tr>
			<tr><td class="bg-info"> Program Manager </td> <td  > {{projectdata.pm}}</td></tr>
			<tr><td class="bg-info"> Firmware Integrator </td> <td  > {{projectdata.fw}}</td></tr>
			<tr><td class="bg-info"> SQ Lead </td> <td  >{{projectdata.sq}}</td></tr>
			<tr><td class="bg-info"> Unique Firmware </td> <td  >{{projectdata.uniquefw}}</td></tr>
			<tr><td class="bg-info"> Branch </td> <td  >{{projectdata.branch}}</td></tr>
			<tr><td class="bg-info"> Project Category </td> <td  >{{projectdata.cat}}</td></tr>
	 	</table>
	 </div>
	<div class="form col-md-6">
     <textarea rows="18" class="form-control" readonly>{{projectdata.tooltip}}</textarea>
    <!--placeholder for the tooltip -->
    </div>
	<hr> 
      	<table id="active-project-table" class="table table-bordered table-condensed">
			<tr style="font-size:12px; font-weight:bold"><th>#</th><th>CRID</th><th>Type</th><th class="cell-summary">Summary</th><th>Requestor</th><th>Fix Provider</th><th>Test Partner</th><th>Affected SKUs</th><th>SHA</th><th>component</th><th>Status</th></tr>
			<tr style="font-size:10px" ng-repeat="x in projectitems"><td> {{$index+1}} </td><td>{{x.crid}}</td><td>{{x.type}}</td><td>{{x.summary}}</td><td>{{x.requestor}}</td><td>{{x.fixer}}</td><td>{{x.testteam}}</td><td>{{x.products}}</td><td>{{x.sha}}</td><td>{{x.component}}</td><td ng-class="selectRight.statusColor(x.status)">{{x.status}}</td></tr>
      	</table>
      </div>
      <div class="modal-footer">
		    <button class="btn btn-warning admin" ng-click="renderModal.importItem()"> Import </button>
			<button class="btn btn-success admin" ng-click="renderModal.addItem()"> Add </button>
			<button class="btn btn-primary admin" ng-click="renderModal.editItem(projectdata.cat)"> Edit </button>
			<button type="button" class="btn btn-danger admin" ng-click="renderModal.delItem()">Delete </button>
			<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>	
      </div>
    </div>

  </div>
</div>
<!-- project charter modal ends-->

<!-- Add item modal begins using directive -->
<div add-item-modal></div> 
<!-- Add item modal ends -->

<!-- import item modal begins using directive -->
<div import-item-modal></div>
<!-- import item modal ends -->

<!-- Modify item modal is defined, can't use "draggable" here, it will break the cursor behavior in input field -->
<!--not using directive here as there will be too many bindings-->
<div class="modal fade" id="modify-item-modal">

	<div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header bg-info">
        	<button type="button" class="close" data-dismiss="modal"><small>Cancel</small>&times;</button>
            <h4 class="modal-title">Modify Project Details - <span>{{projectname}}</span></h4>
        </div>
		<div class="modal-body">
			<div class="panel">
				<div class="panel-body">
					<form id="form-edit-item" ng-submit="editItemSubmit()">
   						 	<div class="col-md-6">
	 							<table id="summary-table" class= "table table-condensed">
									<tr><td  width="30%"> Project Name </td><td><input class="form-control"  name="skus" type="text" value ="{{projectdata.project_name}}"></td></tr>
									<tr><td> SKUs </td><td><input class="form-control"  name="skus" type="text" value ="{{projectdata.skus}}"></td></tr>
									<tr><td> Tagname </td> <td><input class="form-control" name="tag" value ="{{projectdata.tag}}"></td></tr>
									<tr><td> Start Date </td> <td><input class="date-picker form-control" name="datestart" type="text" value ="{{projectdata.datestart}}" pattern="20[0-2][0-9]-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])"></td></tr>
									<tr><td> FC Date </td> <td><input class="date-picker form-control" name="datefc" type="text" value ="{{projectdata.datefc}}" pattern="20[0-2][0-9]-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])"></td></tr>
									<tr><td> RC Date </td> <td><input class="date-picker form-control" name="daterc" type="text" value ="{{projectdata.daterc}}" pattern="20[0-2][0-9]-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])"></td></tr>
									<tr><td> VR Date </td> <td><input class="date-picker form-control" name="datevr" type="text" value ="{{projectdata.datevr}}" pattern="20[0-2][0-9]-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])"></td></tr>
									<tr><td> Program Manager </td> <td><input class="form-control" name="pm"type="text" value ="{{projectdata.pm}}"></td></tr>
									<tr><td> Firmware Integrator </td><td><input class="form-control" name="fw"type="text" value ="{{projectdata.fw}}"></td></tr>
									<tr><td> SQ Lead </td> <td><input class="form-control" type="text" name="sq" value ="{{projectdata.sq}}"></td></tr>
									<tr><td> Unique Firmware </td> <td><input class="form-control" type="text" name="uniquefw" value ="{{projectdata.uniquefw}}"></td></tr>
									<tr><td> Branch </td> <td><input class="form-control" type="text" name="branch" value ="{{projectdata.branch}}"></td></tr>
									<tr><td> Project Category </td> <td><select class="form-control status-select" name="cat"> 
										<option>Major roll</option>
										<option>Minor roll</option>
										</select></td></tr>
									<input type="hidden" class="form-control" name="project_name" value="{{projectname}}">
									<input type="hidden" class="form-control" name="project_id" value="{{projectdata.id}}">
	 							</table>
	 					 	</div>
						<div class="form col-md-6">
    						 <textarea rows="25" class="form-control" name="tooltip">{{projectdata.tooltip}}</textarea>
    							<!--placeholder for the tooltip -->
    					</div>


						<table id = "item-table" class="table table-bordered table-condensed">
							<tr style="font-size:12px" class="fixed-cell"><th>#</th><th>CRID</th><th>Type</th><th class="cell-summary">Summary</th><th>Requestor</th><th>Fix Provider</th><th>Test Partner</th><th>Affected SKUs</th><th>SHA</th><th>Component</th><th>Status</th></tr>
							<tr ng-repeat="x in projectitems">
								<td width="3%">{{$index+1}}</td>
								<td><input class="form-control input-sm input-expand" name="crid[]" type="text" value ="{{x.crid}}"></td>
								<td class="sel-box-col">
									<select class="form-control type-modify-box" name="type[]" ng-init="selectRight.type(x.type, $index)"> 
										<option>Defect Fix</option>
										<option>New Feature</option>
									</select>
								</td>
								<td><input class="form-control input-sm input-expand-more"  name="summary[]" type="text" value ="{{x.summary}}"></td>
								<td><input class="form-control input-sm input-expand" name="requestor[]" type="text" value ="{{x.requestor}}"></td>
								<td><input class="form-control input-sm input-expand" name="fixer[]" type="text" value ="{{x.fixer}}"></td>
								<td><input class="form-control input-sm input-expand" name="testteam[]" type="text" value ="{{x.testteam}}"></td>
								<td><input class="form-control input-sm input-expand" name="products[]" type="text" value ="{{x.products}}"></td>
								<td><input class="form-control input-sm input-expand" name="sha[]" type="text" value ="{{x.sha}}"></td>
								<td class="sel-box-col">
									<select class="form-control component-modify-box" name="component[]" ng-init="selectRight.component(x.component, $index)"> 
										<option>UI</option>
										<option>EWS</option>
										<option>Fax</option>
										<option>Scan</option>
										<option>Mech</option>
										<option>ADF</option>
										<option>Copy</option>
										<option>IDS</option>
										<option>Acumen</option>
										<option>Ink Sub</option>
										<option>Ink Security</option>
										<option>Connectivity</option>
										<option>SIPs</option>
										<option>OXPD</option>
										<option>Digital Send</option>
										<option>LEDM</option>
										<option>General Security</option>
										<option>Mobility</option>
										<option>Datapath</option>
										<option>Board Config</option>
										<option>ASIC</option>
										<option>Power</option>
										<option>Boot Loader</option>
										<option>OS Related</option>
										<option>Others</option>
									</select></td>
								<td class="sel-box-col">
									<select class="form-control status-modify-box" name="status[]" ng-init="selectRight.status(x.status, $index)"> 
										<option>In Progress</option>
										<option>Fixed</option>
										<option>Verified</option>
										<option>Reopen</option>
									</select>
								</td>
								<input class="form-control input-sm" name="id[]" type="hidden" value ="{{x.id}}">
								
							</tr>
						</table>
						<input class="admin btn btn-primary" type="submit" value="Submit" >
					</form>
				    <br>
					<div id="edit-item-status"></div>
					</div>
				</div>
			</div>
		</div>
		<div class="modal-footer"></div>
	</div>
</div>
<!-- Modify item modal ends -->

<!-- Delete item modal is defined -->
<div class="modal fade" id="delete-item-modal">

<div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header bg-success">
          <button type="button" class="close" data-dismiss="modal"><small>Cancel</small>&times;</button>
          <h4 class="modal-title">Select Items To Delete</h4>
        </div>
<div class="modal-body">
<div class="panel">
<div class="panel-body">
<form id="form-del-item" ng-submit="deleteItemSubmit()"> 
<div class="active-project-table-delete">  
      <table class="table table-bordered table-condensed table-striped table-hover">
      <tr><td></td><td>Item</td><td>CRID</td><td>Summary</td></tr>
      <tr style="font-size:12px" ng-repeat="x in projectitems">
	  <!-- Bind the checkbox value to scope variable as an input of the function to display the DELETE button-->
	  <!--LEARNING Bootstrap form-control has issue with checkbox displaying across browsers, so remove the form-control class -->
	  <td><input type="checkbox" name="{{x.id}}" ng-model="checkboxValue[$index]"></td><td>{{$index+1}}</td><td>{{x.crid}}</td><td>{{x.summary}}</td>
      </tr>
      </table>
</div>
<br>
<h5 ng-hide="checkboxChecked()" class="text-success"> Please select one or more items above </h5>
<input class="admin btn btn-danger" type="submit" value="Delete" ng-show="checkboxChecked()">
</form>
<div id="del-item-status"></div>
</div>
</div>
</div>
</div>
<div class="modal-footer"> 
</div>
</div>

</div>
<!-- Delete item modal ends -->


<!--add new project directive -->
<std-add-new-project></std-add-new-project>




<!-- Delete project modal is defined -->
<div class="modal fade" id="delete-project-modal">

<div class="modal-dialog">
<div class="modal-content">
        <div class="modal-header bg-">
          <button type="button" class="close" data-dismiss="modal"><small>Cancel</small>&times;</button>
          <h4 class="modal-title">Select Project To Delete</h4>
        </div>
<div class="modal-body">
<div class="panel">
<div class="panel-body">

<!-- use ng-submit, ng-options for the form submission, and the selected option is availble in $scope.deletedProj.-->
<form id= "delete-pj-form" ng-submit ="delPjSubmit(deletedProj)"> 
<select class="form-control del-project-select" ng-model="deletedProj" ng-change="trackSelectChange()" ng-options="project for project in projectlist">
</select>
<br><br>

<input ng-hide="deletePressed" class="admin btn btn-danger"  ng-click="confirmDelProject()" value="Delete">
<p ng-show="deletePressed" class="text-success"> Do you confirm to delete above project? </P>
<input class="form-control input-sm" type="hidden" name="selectedProj" value ="{{deletedProj}}">
<input ng-show="deletePressed" class="admin btn btn-primary" type="submit" value="Confirm">
</form>

<div id="del-pj-status"></div>

</div>
</div>
</div>
</div>
</div>
</div>
<!-- Delete project modal ends -->

<!--Move project Modal -->
<div id="move-project-modal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title text-primary">Copy {{projectname}} to 【Completed Project】</h4>
      </div>
 <div class="modal-body">
<form action="php/active_cpe_project_move.php" method="post"> 
<div class="form-group">
<div class="form">
<label class="control-label"><small>Category</small></label>
<select class="form-control move-project-select" name="category" ng-model="catToMove" ng-change="loadProductList()" required>
<option>Officejet Pro</option>
<option>Officejet</option>
<option>Page Wide</option>
<option>Consumer</option>
<option>Mobile</option>
</select>
</div>
<div class="form">
<label class="control-label"><small>Select a Product</small></label>
<select class="form-control move-project-select" name="parentproduct">
<option ng-repeat="product in productlist">{{product}}</option>
</select>
<span><small class="bg-warning"><em>For new product, please create an entry first in 'project completed' tab </em></small></span>
</div>
<hr>
<div class="form">
<input type="hidden" name="project" value="{{projectname}}" >
<label class="control-label"><small>Firmware Version</small></label>
<input type="text" class="form-control input-sm" name="revision" style="width:50%" required>
</div>
<div class="form">
<label class="control-label"><small>Return of Investment</small></label>
<input type="text" class="form-control input-sm" name="roi" style="width:50%" required>
</div>
<div class="form">
<label class="control-label"><small>Defect Count</small></label>
<input type="number" class="form-control input-sm" name="defectcount" ng-model="pjDefectCount" style="width:50%" min="0" max = "200" readonly>
</div>
<div class="form">
<label class="control-label"><small>Feature Count</small></label>
<input type="number" class="form-control input-sm" name="featurecount" ng-model="pjFeatureCount" style="width:50%" min="0" max = "200" readonly>
</div>
<hr>
<div class="form">
<label class="control-label"><small>Cloud Publish Date</small></label>
<input class="date-picker form-control" id="live-date-input" name="livedate" type="text" style="width:50%" pattern="[2][0][0-2][0-9][-]([0][1-9]|[1][0-2])[-]([0][1-9]|[1][0-9]|[2][0-9]|[3][0-1])">
<label class="checkbox-inline checkbox-add"><input type="checkbox" id="live-date-check" onchange="inputBoxValidate(event)">Not Applicable</label>
</div>
<div class="form">
<label class="control-label"><small>FDU Publish Date</small></label>
<input class="date-picker form-control" id="fdu-date-input" name="fdudate" type="text" style="width:50%" pattern="[2][0][0-2][0-9][-]([0][1-9]|[1][0-2])[-]([0][1-9]|[1][0-9]|[2][0-9]|[3][0-1])">
<label class="checkbox-inline checkbox-add"><input type="checkbox" id="fdu-date-check" onchange="inputBoxValidate(event)">Not Applicable</label>
</div>
<div class="form">
<label class="control-label"><small>MFG Roll-in Date</small></label>
<input class="date-picker form-control" id="mfg-date-input" name="mfgdate" type="text" style="width:50%" pattern="[2][0][0-2][0-9][-]([0][1-9]|[1][0-2])[-]([0][1-9]|[1][0-9]|[2][0-9]|[3][0-1])">
<label class="checkbox-inline checkbox-add"><input type="checkbox" id="mfg-date-check" onchange="inputBoxValidate(event)">Not Applicable</label>
</div>
<hr>
<div class="form">
<label class="control-label"><small>SHA</small></label>
<input type="text" class="form-control input-sm" name="sha" style="width:90%" required>
</div>
<div class="form">
<label class="control-label"><small>Signature</small></label>
<input type="text" class="form-control input-sm" name="signature" style="width:90%" required>
</div>
<div class="form">
<label class="control-label"><small>Firmware Link</small></label>
<input type="text" class="form-control input-sm" name="fwlink" style="width:90%" required>
</div>


<br>
<input type="submit" class="btn btn-primary" value="submit">	  
 </div>

</div>
 </form>
</div>
</div>
</div>
</div>
<!-- Move project Modal end-->

<!-- alert Modal -->
<div id="alert-modal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title alert-modal-title">Alert!</h4>
      </div>
      <div class="modal-body">
        <p>{{alertcontent}}</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>


<!--tooltip modal -->

<div id="tooltip-modal" class="modal fade">
 <div class="modal-dialog">
 
 <div class="modal-content">
 <div class="modal-header">
   <button type="button" class="close" data-dismiss="modal"><small>Cancel</small>&times;</button>
 <h4 class="modal-title text-primary"><center>Modify Tooltip </center></h4>
 </div>
 
<div class="modal-body">
<form id="tooltip-form">
<button class="btn btn-info" ng-click="insertDate()">Insert Date </button>
<br>
<input type="hidden" name="rootindex" value="{{ttEntry.rootindex}}">
<textarea name="tooltip">modify tooltip</textarea>
</form>
<div id="tooltip-edit-status"></div>
</div>

<div class ="modal-footer">
<button class="btn btn-primary" ng-click= "submitTooltip()">Submit </button>
</div>
</div>
</div>
</div>

<!-- upload preview modal-->
<div id="preview-modal" class="modal fade" role="dialog">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
			<h4 class="modal-title text-primary"><center>Preview</center></h4>
			<button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>

      <div class="modal-body">
      	<table id="preview-table" class="table table-bordered table-condensed">
			<tr><th>#</th><th>CRID</th><th>Type</th><th class="cell-summary">Summary</th><th>Requestor</th><th>Fix Provider</th><th>Test Partner</th><th>Affected SKUs</th><th>SHA</th><th>component</th><th>Status</th></tr>
			<tr ng-repeat="x in previewlist"><td> {{$index+1}} </td><td ng-class="preValidate.empty(x.crid)">{{x.crid}}</td><td ng-class="preValidate.type(x.type)">{{x.type}}</td><td ng-class="preValidate.empty(x.summary)">{{x.summary}}</td>
			<td ng-class="preValidate.empty(x.requestor)">{{x.requestor}}</td><td ng-class="preValidate.empty(x.fixer)">{{x.fixer}}</td><td ng-class="preValidate.empty(x.testteam)">{{x.testteam}}</td>
			<td ng-class="preValidate.empty(x.products)">{{x.products}}</td><td ng-class="preValidate.empty(x.sha)">{{x.sha}}</td><td ng-class="preValidate.comp(x.component)">{{x.component}}</td><td ng-class="preValidate.status(x.status)">{{x.status}}</td></tr>
      	</table>
		<center><h4>Note: Fields in YELLOW are not compulsory to be corrected, but highly recommended to to so. </h4></center>
      </div>
      <div class="modal-footer">
			<button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>
<!-- update preview modal ends-->




</div>





</body>

</html>